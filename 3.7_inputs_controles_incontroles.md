## Bon √† savoir : 

| Type d'Input	| D√©finition |
|---------------|------------|
| **Input contr√¥l√©**	| L'input est li√© √† un `useState` ‚Üí chaque modification **d√©clenche un rendu React**. |
| **Input incontr√¥l√©**	| L'input est **g√©r√© par une** `ref`, sans passer par React ‚Üí React ne suit pas son contenu en temps r√©el. |

üõ† **Voici ce qu'on va construire maintenant** :

On va ajouter **un champ** `<input>` **contr√¥l√©** au-dessus de ta calculatrice pour :

* Saisir une formule compl√®te (ex: `12+5`).
* Valider et calculer directement via ce champ.

Et **un input incontr√¥l√©** pour :

* Un champ cach√© ou une saisie rapide directe, **sans mettre √† jour l'√©tat React** en temps r√©el.

---

### üì¶ Modification du projet

1. **Cr√©er un `useState` pour l'input contr√¥l√©**

Dans `Calculator.jsx`, ajoute en haut :

```jsx
const [manualInput, setManualInput] = React.useState('');
const manualInputRef = React.useRef();
```

‚úÖ `manualInput` sera ton input contr√¥l√©.

‚úÖ `manualInputRef` sera ton input incontr√¥l√©.

2. **Ajout de champs dans le rendu**

Juste avant ton `<Display />`, ajoute :

```jsx
<div style={{ marginBottom: '10px' }}>
  {/* Input contr√¥l√© */}
  <input
    type="text"
    placeholder="Tapez votre op√©ration (ex: 3+2)"
    value={manualInput}
    onChange={(e) => setManualInput(e.target.value)}
    style={{ width: '100%', padding: '5px', marginBottom: '5px' }}
  />

  {/* Boutons d'action */}
  <div style={{ display: 'flex', gap: '10px' }}>
    <button onClick={handleControlledSubmit}>Calculer Contr√¥l√©</button>
  </div>
</div>
```

3. **Cr√©er les fonctions d'action**

Dans `Calculator.jsx`, ajoute en dessous de tes fonctions :

```jsx
const handleControlledSubmit = () => {
  if (manualInput) {
    try {
      const calculated = eval(manualInput);
      setResult(calculated);
    } catch (error) {
      setErrorMessage("Erreur de saisie !");
    }
  }
};
```
* `handleControlledSubmit()` utilise la valeur de l'input contr√¥l√© (li√© au `useState`).

---

üëÄ **Le probl√®me**

Quand tu tapes au clavier, les touches vont sur l‚Äô√©cran de la calculatrice (le `handleKeyDown` capte tout).

üëâ M√™me si ton curseur est dans un champ `<input>`, la calculatrice intercepte l'√©v√©nement clavier.

‚úÖ **Solution propre**

Il faut ignorer le traitement du clavier si le focus est d√©j√† dans un input.

### Modifier `handleKeyDown` comme ceci :

```jsx
const handleKeyDown = (event) => {
  const target = event.target;

  // ‚ùó Ne pas interf√©rer si l'utilisateur est en train de taper dans un input ou textarea
  if (target.tagName === "INPUT" || target.tagName === "TEXTAREA") {
    return;
  }

  // Logique pour les autres touches
};
```

---

### Ajouter un input incontr√¥l√©

Dans `Calculator.jsx`, ajoute :

```jsx
<div style={{ marginBottom: '10px' }}>
  {/* Input incontr√¥l√© */}
  <input
    type="text"
    ref={manualInputRef}
    placeholder="Input rapide (pas suivi par React)"
    style={{ width: '100%', padding: '5px', marginBottom: '10px' }}
  />

  {/* Boutons d'action */}
  <div style={{ display: 'flex', gap: '10px' }}>
    {/* ... */}
    <button onClick={handleUncontrolledSubmit}>Calculer Incontr√¥l√©</button>
  </div>
</div>
```

### Cr√©er `handleUncontrolledSubmit`

```jsx
const handleUncontrolledSubmit = () => {
  if (manualInputRef.current && manualInputRef.current.value) {
    try {
      const calculated = eval(manualInputRef.current.value);
      setResult(calculated);
    } catch (error) {
      setErrorMessage("Erreur de saisie !");
    }
  }
};
```
* `handleUncontrolledSubmit()` utilise directement la valeur de l'input via `ref`, sans passer par React.

---

### ‚öñÔ∏è Input contr√¥l√© vs Input incontr√¥l√© ‚Äî le vrai comparatif

![Input Contr√¥l√© vs Incontr√¥l√©](./img/inputControleVSIncontrole)

---

### üìö R√©sum√© clair

**‚úÖ Input contr√¥l√©** :
- Utilis√© quand :
  - Tu veux **valider ou filtrer en temps r√©el**.
  - Tu veux afficher des erreurs, auto-compl√©tion, ou champs conditionnels.
  - Tu as besoin de **logique r√©active** √† chaque frappe.
  
**Exemples** :
  - Saisie de nom ou mot de passe.
  - Formulaires de paiement.
  - Barre de recherche avec suggestions.

**‚úÖ Input incontr√¥l√©** :
- Utilis√© quand :
  - Tu veux juste **r√©cup√©rer la valeur au moment de la soumission**.
  - Tu n‚Äôas **pas besoin de valider ou r√©agir √† chaque changement**.
  - Tu veux **√©viter des re-renders** inutiles (optimisation).

**Exemples** :
  - Upload de fichier.
  - Champ de recherche simple.
  - Formulaires embarqu√©s dans du contenu statique.